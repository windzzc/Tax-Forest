<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" >
  <title>New Yotta</title>
  <!-- Tell the browser to be responsive to screen width -->
  <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
  <!-- Bootstrap 3.3.6 -->
  <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css">
  <!-- Font Awesome -->
  <link href="http://cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
  <!-- Ionicons -->
  <link href="http://cdn.bootcss.com/ionicons/2.0.0/css/ionicons.min.css" rel="stylesheet">
  <!-- Theme style -->
  <link rel="stylesheet" href="dist/css/AdminLTE.css">
  <!-- AdminLTE Skins. Choose a skin from the css/skins
       folder instead of downloading all of them to reduce the load. -->
  <link rel="stylesheet" href="dist/css/skins/_all-skins.css">
<!-- <script type="text/javascript">ip = ffsfdsf；</script> -->

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->




</head>
<body class="hold-transition skin-blue sidebar-mini">
<div class="wrapper">

  <header class="main-header">
    <!-- Logo -->
    <a href="http://yotta.xjtushilei.com:888/homepage/" class="logo">
      <!-- mini logo for sidebar mini 50x50 pixels -->
      <span class="logo-mini" style="font-size: 12px">知识森林</span>
      <!-- logo for regular state and mobile devices -->
      <span class="logo-lg">知识森林构建</span>
    </a>
    <!-- Header Navbar: style can be found in header.less -->
    <nav class="navbar navbar-static-top">
      <!-- Sidebar toggle button-->
   
      <a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">
        <span class="sr-only">Toggle navigation</span>
      </a>
          <br>
        <div class="col-md-1">
        </div>
          <div class="col-md-1"></div>
        <div class="col-md-8">
            <div class="btn-group btn-group-lg" role="group" aria-label="...">

 <a href="../construct/pages/facet/index.html">
<button class="btn  btn-primary"> 知识主题抽取及分面树构建</button> 
<button class="btn  btn-primary"><em class="glyphicon glyphicon-arrow-right"></em></button> 
</a>
 <a href="../construct/pages/add/index.html">
<button class="btn  btn-primary"> 碎片化知识采集及转配</button> 
<button class="btn  btn-primary"><em class="glyphicon glyphicon-arrow-right"></em></button> 
</a>
<a href="../construct/pages/relationship/index.html">
<button class="btn  btn-primary "> 知识关系挖掘</button> 
<button class="btn  btn-primary "><em class="glyphicon glyphicon-arrow-right"></em></button> 
</a>
 <a href="../construct/pages/kg/index.html">
<button class="btn  btn-primary btn6"> 知识森林</button> 
</a>

          </div>
      </div>        
        <div class="col-md-1"></div>
        <div class="col-md-1"></div>
      <br>

      <div class="collapse navbar-collapse pull-right" id="navbar-collapse">
        <ul class="nav navbar-nav">
          <li><a href="../../index.html" ><i class="fa fa-home" style="font-size: 19px"></i><strong> New Yotta</strong></a></li>
        </ul>
      </div>

      
    </nav>
  </header>
  <!-- Left side column. contains the logo and sidebar -->
  <aside class="main-sidebar">
    <!-- sidebar: style can be found in sidebar.less -->
    <section class="sidebar">
      <!-- Sidebar user panel -->

      <!-- /.search form -->
      <!-- sidebar menu: : style can be found in sidebar.less -->
      <ul class="sidebar-menu">
        <li class="header">主要功能</li>
        <li class="active">
           <a href="javascript:resetCookie()"><i class="fa fa-location-arrow"></i> <span>导航</span>
         
           </a>
 <div class="hei"> <i class="glyphicon glyphicon-arrow-down"></i></div>
        </li>

        <li>
          <a href="pages/facet/index.html">
            <i class="fa fa-asterisk"></i> <span>主题抽取和分面树构建</span>            
          </a>
          <div class="hei"> <i class="glyphicon glyphicon-arrow-down"></i></div>
        </li>  

        <li>
          <a href="pages/add/index.html">
            <i class="fa fa-hourglass-half"></i> <span>碎片化知识采集及装配</span>
          </a>
          <div class="hei"> <i class="glyphicon glyphicon-arrow-down"></i></div>
        </li>
  
         <li>
          <a href="pages/relationship/index.html">
            <i class="fa fa-object-ungroup"></i> <span>知识关联挖掘</span>
          </a>
           <div class="hei"> <i class="glyphicon glyphicon-arrow-down"></i></div>
        </li>

        <li>
          <a href="pages/kg/index.html">
            <i class="fa  fa-tree"></i> <span>知识森林</span>
          </a>

        </li>
      </ul>
      
    </section>
    <!-- /.sidebar -->
  </aside>

  <!-- Content Wrapper. Contains page content -->
  <div class="content-wrapper" ng-app="myApp"  ng-controller="menu">
    <!-- Content Header (Page header) -->

  <div class="row">
  <div class="col-md-12">  <h2>  &nbsp; &nbsp; <b > 导航</b></h2>
    &nbsp; &nbsp; &nbsp; 
    <span class="glyphicon glyphicon-tree-conifer"></span>
            <span style="font-size: 16px; font-weight:bolder;">请选择知识森林已有课程：</span>
  </div>
  </div>

 

    <div class="row">

      <div class="col-sm-12 col-md-5">
  
   
               &nbsp; &nbsp;&nbsp;

           <!--  <select class="btn  btn-success btn-lg " ng-model="subject" ng-options="subject.subjectName for subject in subjects">
              <option value="">-- 请选择学科 --</option> 
            </select>
 -->
 <form action="">
             <select class="btn  btn-success btn-lg subjec"  lay-filter="test" >
              <option value="">-- 请选择学科 --</option> 
            </select>

              <input type="text"  list="idee"  class="btn-success btn-lg"  id="bt"  placeholder="请选择课程" />
              <datalist id="idee">
              <option value="选择课程" ></option>
  



              </datalist>
                 
       



            <select class="btn btn-lg btn-success " ng-model="domain" ng-options="domain.domainName for domain in subject.domains" ng-change="change()"   >
             
            </select>

</form>

        
            <span style="font-family: 微软黑体">目前含: <b><a ng-bind="subjectNum"></a></b> 个学科，<b><a ng-bind="classSum"></a></b> 门课程</span>
      
  
     <!--  <ol class="breadcrumb">
        <li><a href="#"><i class="fa fa-dashboard"></i> 知识森林构建导航</a></li>
      </ol> -->

      </div>
      <div class="col-md-7"></div>

        </div>


 
<div class="row">
  <div class="col-md-8">
            <div id="graph" style="width: 800px; height:600px; margin:auto"></div>
        </div>
        <div class="col-md-4">放置统计信息</div>

</div>



     
<br>

<div class="row" style="position:absolute;bottom:0;margin-right:2%;padding-left: 2%;">
    <!-- <strong>Copyright &copy; 2016 <a href="http://labs.xjtudlc.com/labs/index.html">大数据算法与分析技术国家工程实验室</a>.</strong> All rights -->
<div class="col-md-12">


 <strong>Copyright © 2019 智能网络与网络安全教育部重点实验室. All rights
    reserved.</strong> 

    <b>Version 1.0.1</b> 

</div>

  



</div>

<input type="button" value="123" id="buttonn">
  <!-- /.content-wrapper -->
<!--   <footer class="main-footer">
    <div class="pull-right hidden-xs">
      <b>Version</b> 1.0.1
    </div>
    <strong>Copyright &copy; 2019 智能网络与网络安全教育部重点实验室.</strong> All rights
    reserved.
  </footer> -->


  <!-- /.control-sidebar -->
  <!-- Add the sidebar's background. This div must be placed
       immediately after the control sidebar -->
  <div class="control-sidebar-bg"></div>
</div>
<!-- ./wrapper -->

<!-- jQuery 2.2.3 -->
<script src="plugins/jQuery/jquery-2.2.3.min.js"></script>

<!-- Bootstrap 3.3.6 -->
<script src="bootstrap/js/bootstrap.min.js"></script>

<!-- AdminLTE App -->
<script src="dist/js/app.min.js"></script>

<script src="././plugins/echartjs/echarts.min.js"></script>
    
 <script src="././plugins/dataTool.min.js"></script>



<!-- 个人的插件 -->
<script type="text/javascript" src="../../config/ipconfig.js"></script>

<script src="plugins/angularjs/angular.js"></script>
<script src="plugins/angularjs/angular-animate.js"></script>
<script src="plugins/angularjs/angular-sanitize.js"></script>
<script src="././plugins/layui/layui.all.js"></script>

<script src="dist/js/daohang.js"></script>
<script>

layui.use(['form', 'layedit', 'laydate'], function(){
  var form = layui.form
  ,layer = layui.layer
  ,layedit = layui.layedit
  ,laydate = layui.laydate;


       $.ajax({
            type: "GET",
            url: ip+"/domain/getDomainsGroupBySubject",
           
            headers:{'Content-Type': 'application/x-www-form-urlencoded'},        
            success: function(response){
                console.log(response['data']);
                 data = response["data"];
               $.each(response["data"],function(k,v){
                 var op = "";
                        op += "<option value='"+v.subjectName+"'>"+v.subjectName+"</option>";                      
                      $(".subjec").append(op);

               })
             
            },
            error:function(XMLHttpRequest, textStatus, errorThrown){               
                console.log(XMLHttpRequest);        
             
        }

})


form.on('select(test)', function(data){
    console.log(data.value); //得到被选中的值
  layer.alert(data);
});

return false;





$("#bt").click(function(){


var subject=$(".subjec option:selected").val();

console.log(subject);
      $.ajax({
            type: "GET",
            url: ip+"/domain/getDomainsBySubject",
           data: $.param( {
                subjectName:subject,      
            }),
            headers:{'Content-Type': 'application/x-www-form-urlencoded'},        
            success: function(response){
                  var domain=response['data'];
                 console.log(domain);
                  //console.log(response['data']['2']['domainName'])
                 // for(j = 0; j < domain.length; j++) {              
              
                 //    for(var domainName in domain[j]){

                 //    　　　　console.log(domainName+':'+ domain[j][domainName]);

                 //    　　}
                     
                 //    }
                 
                  $.each(domain, function (n, value) {
                        
                        var trs = "";
                        trs += "<option value='"+value.domainName+"'/>";
                        console.log(trs);
                      $("#idee").append(trs);
                       
                     
                    });








                 
            }
             
        

})



})




})



















  // 画图的脚本
        var chart = echarts.init($('#graph').get(0));

        // 课程名
        var subjectName = '计算机科学'

        // 获取gephi图
        $.get('http://yotta.xjtushilei.com:8084/subject/getSubjectGraphByName?subjectName=' + encodeURIComponent(subjectName), function (response) {
            gexf = response.data;
            drawGraph(gexf, subjectName, chart);
        })

        function drawGraph(gexf, subjectName, chart) {
            let graph = echarts.dataTool.gexf.parse(gexf);
            let categories = [];
            let communityCount = 0;

            graph.nodes.forEach(function (node) {
                communityCount = Math.max(communityCount, node.attributes.modularity_class);
                node.itemStyle = null;
                node.value = node.symbolSize;
                node.category = node.attributes.modularity_class;
                node.label = {
                    normal: {
                        show: node.symbolSize > 0
                    }
                };
                node.symbolSize = node.symbolSize / 3 + 6;
            });
            let communitySize = [];
            for (let i = 0; i <= communityCount; i++) {
                categories[i] = { name: '社团' + (i + 1) };
                communitySize[i] = 0;
            }
            graph.nodes.forEach(function (node) {
                let size = node.symbolSize;
                let community = node.attributes.modularity_class;
                for (let i = 0; i <= communityCount; i++) {
                    if (community === i) {
                        if (size > communitySize[i]) {
                            categories[i] = { name: node.name };
                        }
                    }
                }
            });

            let option = {
                title: {
                    text: subjectName,
                    top: '90%',
                    left: 'right'
                },
                tooltip: {},
                legend: {
                    top: 'top',
                    data: categories.map(function (a) {
                        return a.name;
                    }),
                    textStyle: {
                        fontSize: 14
                    }
                },
                animationDuration: 1500,
                animationEasingUpdate: 'quinticInOut',
                series: [
                    {
                        name: subjectName,
                        type: 'graph',
                        layout: 'none',
                        data: graph.nodes,
                        links: graph.links,
                        top: '15%',
                        edgeSymbol: ['circle', 'arrow'],
                        edgeSymbolSize: [0.5, 7],
                        categories: categories,
                        focusNodeAdjacency: true,
                        roam: true,
                        label: {
                            normal: {
                                position: 'right'
                            }
                        },
                        lineStyle: {
                            normal: {
                                curveness: 0.25,
                                color: 'source',
                                width: 3
                            }
                        }
                    }
                ]
            };

            // 点击事件
            chart.on('click', function (param) {
                switch (param.dataType) {
                    // 结点类型
                    case 'node':
                        // 输出结点名称
                        console.log(param.data.name);
                        break;
                    // 边类型
                    case 'edge':
                        // 输出边两侧的结点
                        console.log(param.data.source);
                        console.log(param.data.target);
                }
               
            });

            chart.setOption(option);
        }




</script>



</body>
</html>
